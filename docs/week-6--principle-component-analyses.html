<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Week 6- Principle Component Analyses | MarGen2022</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.26.2 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Week 6- Principle Component Analyses | MarGen2022" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Week 6- Principle Component Analyses | MarGen2022" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="population-structure-via-construct.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Marine Genomics 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to Marine Genomics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#cloud-computing-versus-individual-laptops"><i class="fa fa-check"></i><b>1.1</b> Cloud computing versus individual laptops</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#meet-our-instructors"><i class="fa fa-check"></i><b>1.2</b> Meet our instructors!</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.3</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1--welcome.html"><a href="week-1--welcome.html"><i class="fa fa-check"></i><b>2</b> Week 1- Welcome!</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1--welcome.html"><a href="week-1--welcome.html#introduction-to-shell-computing-via-the-data-carpentry-tutorial"><i class="fa fa-check"></i><b>2.1</b> Introduction to shell computing via the data carpentry tutorial</a></li>
<li class="chapter" data-level="2.2" data-path="week-1--welcome.html"><a href="week-1--welcome.html#how-to-access-the-shell"><i class="fa fa-check"></i><b>2.2</b> How to access the shell</a></li>
<li class="chapter" data-level="2.3" data-path="week-1--welcome.html"><a href="week-1--welcome.html#best-practices-for-jetstream"><i class="fa fa-check"></i><b>2.3</b> Best practices for Jetstream</a></li>
<li class="chapter" data-level="2.4" data-path="week-1--welcome.html"><a href="week-1--welcome.html#week-1-objectives"><i class="fa fa-check"></i><b>2.4</b> Week 1 Objectives</a></li>
<li class="chapter" data-level="2.5" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-your-file-system"><i class="fa fa-check"></i><b>2.5</b> Navigating your file system</a></li>
<li class="chapter" data-level="2.6" data-path="week-1--welcome.html"><a href="week-1--welcome.html#shortcut-tab-completion"><i class="fa fa-check"></i><b>2.6</b> Shortcut: Tab Completion</a></li>
<li class="chapter" data-level="2.7" data-path="week-1--welcome.html"><a href="week-1--welcome.html#summary-key-points"><i class="fa fa-check"></i><b>2.7</b> Summary &amp; Key Points</a></li>
<li class="chapter" data-level="2.8" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-files-and-directories"><i class="fa fa-check"></i><b>2.8</b> Navigating Files and Directories</a></li>
<li class="chapter" data-level="2.9" data-path="week-1--welcome.html"><a href="week-1--welcome.html#moving-around-the-file-system"><i class="fa fa-check"></i><b>2.9</b> Moving around the file system</a></li>
<li class="chapter" data-level="2.10" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-practice-and-finding-hidden-directories"><i class="fa fa-check"></i><b>2.10</b> Navigating practice and finding hidden directories</a></li>
<li class="chapter" data-level="2.11" data-path="week-1--welcome.html"><a href="week-1--welcome.html#examining-the-contents-of-other-directories"><i class="fa fa-check"></i><b>2.11</b> Examining the contents of other directories</a></li>
<li class="chapter" data-level="2.12" data-path="week-1--welcome.html"><a href="week-1--welcome.html#full-vs-relative-paths"><i class="fa fa-check"></i><b>2.12</b> Full vs Relative Paths</a></li>
<li class="chapter" data-level="2.13" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigational-shortcuts"><i class="fa fa-check"></i><b>2.13</b> Navigational shortcuts</a></li>
<li class="chapter" data-level="2.14" data-path="week-1--welcome.html"><a href="week-1--welcome.html#key-points"><i class="fa fa-check"></i><b>2.14</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html"><i class="fa fa-check"></i><b>3</b> Week 2-Working With Files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#our-data-set-fastq-files"><i class="fa fa-check"></i><b>3.1</b> Our data set: FASTQ files</a></li>
<li class="chapter" data-level="3.2" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#wildcards"><i class="fa fa-check"></i><b>3.2</b> Wildcards</a></li>
<li class="chapter" data-level="3.3" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#command-history"><i class="fa fa-check"></i><b>3.3</b> Command History</a></li>
<li class="chapter" data-level="3.4" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#examining-files"><i class="fa fa-check"></i><b>3.4</b> Examining Files</a></li>
<li class="chapter" data-level="3.5" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#details-on-the-fastq-format"><i class="fa fa-check"></i><b>3.5</b> Details on the FASTQ format</a></li>
<li class="chapter" data-level="3.6" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#creating-moving-copying-and-removing"><i class="fa fa-check"></i><b>3.6</b> Creating, moving, copying, and removing</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#copying-files"><i class="fa fa-check"></i><b>3.6.1</b> Copying Files</a></li>
<li class="chapter" data-level="3.6.2" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#creating-directories"><i class="fa fa-check"></i><b>3.6.2</b> Creating Directories</a></li>
<li class="chapter" data-level="3.6.3" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#moving-renaming"><i class="fa fa-check"></i><b>3.6.3</b> Moving / Renaming</a></li>
<li class="chapter" data-level="3.6.4" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#file-permissions"><i class="fa fa-check"></i><b>3.6.4</b> File Permissions</a></li>
<li class="chapter" data-level="3.6.5" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#removing"><i class="fa fa-check"></i><b>3.6.5</b> Removing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#searching-within-editing-and-redirecting-files"><i class="fa fa-check"></i><b>3.7</b> Searching within, editing, and redirecting files</a></li>
<li class="chapter" data-level="3.8" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#searching-files"><i class="fa fa-check"></i><b>3.8</b> Searching files</a></li>
<li class="chapter" data-level="3.9" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#redirecting-output"><i class="fa fa-check"></i><b>3.9</b> Redirecting output</a></li>
<li class="chapter" data-level="3.10" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#writing-scripts-and-working-with-data"><i class="fa fa-check"></i><b>3.10</b> Writing Scripts and Working with Data</a></li>
<li class="chapter" data-level="3.11" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#writing-files"><i class="fa fa-check"></i><b>3.11</b> Writing files</a></li>
<li class="chapter" data-level="3.12" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#writing-scripts"><i class="fa fa-check"></i><b>3.12</b> Writing scripts</a></li>
<li class="chapter" data-level="3.13" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#computing-magic-with-for-loops"><i class="fa fa-check"></i><b>3.13</b> Computing magic with for loops</a></li>
<li class="chapter" data-level="3.14" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#using-basename-in-for-loops"><i class="fa fa-check"></i><b>3.14</b> Using Basename in for loops</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html"><i class="fa fa-check"></i><b>4</b> Week 3- What is a Genetic Variant?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#to-get-started-lets-dowload-the-data-and-install-a-few-programs"><i class="fa fa-check"></i><b>4.1</b> To get started lets dowload the data and install a few programs</a></li>
<li class="chapter" data-level="4.2" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#raw-read-quality-control"><i class="fa fa-check"></i><b>4.2</b> Raw read quality control</a></li>
<li class="chapter" data-level="4.3" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#trimming-to-remove-adapters"><i class="fa fa-check"></i><b>4.3</b> Trimming to remove adapters</a></li>
<li class="chapter" data-level="4.4" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#building-an-index-of-our-genome"><i class="fa fa-check"></i><b>4.4</b> Building an index of our genome</a></li>
<li class="chapter" data-level="4.5" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#map-reads-to-the-genome"><i class="fa fa-check"></i><b>4.5</b> Map reads to the genome</a></li>
<li class="chapter" data-level="4.6" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#sam-to-bam-file-conversion"><i class="fa fa-check"></i><b>4.6</b> sam to bam file conversion</a></li>
<li class="chapter" data-level="4.7" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#genotype-likelihoods"><i class="fa fa-check"></i><b>4.7</b> Genotype likelihoods</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html"><i class="fa fa-check"></i><b>5</b> Week 4 - The R environment</a>
<ul>
<li class="chapter" data-level="5.1" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#create-a-project-in-rstudio"><i class="fa fa-check"></i><b>5.1</b> Create a project in Rstudio</a></li>
<li class="chapter" data-level="5.2" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#orientation-to-r-studio"><i class="fa fa-check"></i><b>5.2</b> Orientation to R studio</a></li>
<li class="chapter" data-level="5.3" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#manipulating-a-vector-object"><i class="fa fa-check"></i><b>5.3</b> Manipulating a vector object</a></li>
<li class="chapter" data-level="5.4" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#characterizing-a-dataframe"><i class="fa fa-check"></i><b>5.4</b> Characterizing a dataframe</a></li>
<li class="chapter" data-level="5.5" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#how-to-access-parts-of-the-data"><i class="fa fa-check"></i><b>5.5</b> How to access parts of the data</a></li>
<li class="chapter" data-level="5.6" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#data-manipulation"><i class="fa fa-check"></i><b>5.6</b> Data Manipulation</a></li>
<li class="chapter" data-level="5.7" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#practice-exploring-a-dataframe"><i class="fa fa-check"></i><b>5.7</b> Practice exploring a dataframe</a></li>
<li class="chapter" data-level="5.8" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#subsetting-datasets-logicals"><i class="fa fa-check"></i><b>5.8</b> Subsetting datasets &amp; logicals</a></li>
<li class="chapter" data-level="5.9" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#practice-subsetting-datasetslogicals"><i class="fa fa-check"></i><b>5.9</b> Practice Subsetting datasets/logicals</a></li>
<li class="chapter" data-level="5.10" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#a-few-tips-for-coding-in-rstudio"><i class="fa fa-check"></i><b>5.10</b> A few tips for coding in Rstudio</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html"><i class="fa fa-check"></i><b>6</b> Week 5- R Continued</a>
<ul>
<li class="chapter" data-level="6.1" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#plotting"><i class="fa fa-check"></i><b>6.1</b> 2.1 Plotting</a></li>
<li class="chapter" data-level="6.2" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#scatterplots"><i class="fa fa-check"></i><b>6.2</b> Scatterplots</a></li>
<li class="chapter" data-level="6.3" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#customizing-your-plot"><i class="fa fa-check"></i><b>6.3</b> Customizing your plot</a></li>
<li class="chapter" data-level="6.4" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#histograms-and-box-plots"><i class="fa fa-check"></i><b>6.4</b> Histograms and box plots</a></li>
<li class="chapter" data-level="6.5" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#practice-problems-2.1"><i class="fa fa-check"></i><b>6.5</b> Practice Problems 2.1</a></li>
<li class="chapter" data-level="6.6" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>6.6</b> 2.2 plotting with ggplot2</a></li>
<li class="chapter" data-level="6.7" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#group-exercise-on-data-visualization"><i class="fa fa-check"></i><b>6.7</b> Group Exercise on Data Visualization</a></li>
<li class="chapter" data-level="6.8" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#practice-problems-2.2"><i class="fa fa-check"></i><b>6.8</b> Practice Problems 2.2</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html"><i class="fa fa-check"></i><b>7</b> Population Structure via conStruct</a>
<ul>
<li class="chapter" data-level="7.1" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#download-the-data"><i class="fa fa-check"></i><b>7.1</b> Download the data</a></li>
<li class="chapter" data-level="7.2" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#update-our-compiler-in-bashunix-and-install-everything-for-r-in-the-terminal-in-bashunix-not-in-rstudio"><i class="fa fa-check"></i><b>7.2</b> update our compiler in bash/UNIX and install everything for R in the terminal (in bash/UNIX, NOT in Rstudio)</a></li>
<li class="chapter" data-level="7.3" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#install-construct-in-r"><i class="fa fa-check"></i><b>7.3</b> install conStruct in R</a></li>
<li class="chapter" data-level="7.4" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#read-in-the-data"><i class="fa fa-check"></i><b>7.4</b> read in the data</a></li>
<li class="chapter" data-level="7.5" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#get-our-meta-data-read-into-r-and-ready-to-use"><i class="fa fa-check"></i><b>7.5</b> Get our meta data read into R and ready to use</a></li>
<li class="chapter" data-level="7.6" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#run-a-structure-analysis"><i class="fa fa-check"></i><b>7.6</b> Run a structure analysis</a></li>
<li class="chapter" data-level="7.7" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#incoorporate-geographic-distances-in-a-spatial-model"><i class="fa fa-check"></i><b>7.7</b> Incoorporate geographic distances in a spatial model</a></li>
<li class="chapter" data-level="7.8" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#comparisons-across-different-values-of-k"><i class="fa fa-check"></i><b>7.8</b> Comparisons across different values of K</a></li>
<li class="chapter" data-level="7.9" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#exercises"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html"><i class="fa fa-check"></i><b>8</b> Week 6- Principle Component Analyses</a>
<ul>
<li class="chapter" data-level="8.1" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#download-the-data-1"><i class="fa fa-check"></i><b>8.1</b> Download the data</a></li>
<li class="chapter" data-level="8.2" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#installing-programs"><i class="fa fa-check"></i><b>8.2</b> Installing programs</a></li>
<li class="chapter" data-level="8.3" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#run-pcangsd-on-our-data"><i class="fa fa-check"></i><b>8.3</b> Run pcangsd on our data</a></li>
<li class="chapter" data-level="8.4" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#setting-up-a-new-project-in-r"><i class="fa fa-check"></i><b>8.4</b> Setting up a new project in R</a></li>
<li class="chapter" data-level="8.5" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#reading-data-into-r"><i class="fa fa-check"></i><b>8.5</b> Reading data into R</a></li>
<li class="chapter" data-level="8.6" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#group-exercises"><i class="fa fa-check"></i><b>8.6</b> Group Exercises</a></li>
<li class="chapter" data-level="8.7" data-path="week-6--principle-component-analyses.html"><a href="week-6--principle-component-analyses.html#additional-exercise"><i class="fa fa-check"></i><b>8.7</b> Additional Exercise</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-6--principle-component-analyses" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Week 6- Principle Component Analyses<a href="week-6--principle-component-analyses.html#week-6--principle-component-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In week 3 we mapped reads to a genome so we could call our genetic variants (SNPs) and generated bam files for each read file (= sequence data from an individual). Last week we started investigating population structure with structure plots via conStruct. We will now use these SNPs to plot patterns of population structure in a different way with principal component analyses.</p>
<p>The first portion of this lesson will be performed in <strong>bash</strong> and then we will generate the plots in <strong>RStudio</strong>.</p>
<div id="download-the-data-1" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Download the data<a href="week-6--principle-component-analyses.html#download-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We first need to download the data. Use the link below to download it to jetstream, and then us the tar command to un-compress it.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb406-1"><a href="week-6--principle-component-analyses.html#cb406-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-2"><a href="week-6--principle-component-analyses.html#cb406-2" aria-hidden="true" tabindex="-1"></a>wget https://raw.githubusercontent.com/BayLab/MarineGenomicsData/main/Week7_2022.tar.gz</span>
<span id="cb406-3"><a href="week-6--principle-component-analyses.html#cb406-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-4"><a href="week-6--principle-component-analyses.html#cb406-4" aria-hidden="true" tabindex="-1"></a>tar -xzvf Week7_2022.tar.gz</span></code></pre></div>
<p>Our data this week consists of genotype_likelihood files in beagle format and a bam.filelist which contains id information for our samples.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb407-1"><a href="week-6--principle-component-analyses.html#cb407-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-2"><a href="week-6--principle-component-analyses.html#cb407-2" aria-hidden="true" tabindex="-1"></a>ls -lh MarineGenomicsData/Week7</span></code></pre></div>
</div>
<div id="installing-programs" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Installing programs<a href="week-6--principle-component-analyses.html#installing-programs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will also need to install a few programs. The code below installs the program pcangsd, and a few dependencies for pcangsd:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb408-1"><a href="week-6--principle-component-analyses.html#cb408-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-2"><a href="week-6--principle-component-analyses.html#cb408-2" aria-hidden="true" tabindex="-1"></a>#install pip for python</span>
<span id="cb408-3"><a href="week-6--principle-component-analyses.html#cb408-3" aria-hidden="true" tabindex="-1"></a>curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py</span>
<span id="cb408-4"><a href="week-6--principle-component-analyses.html#cb408-4" aria-hidden="true" tabindex="-1"></a>python3 get-pip.py</span>
<span id="cb408-5"><a href="week-6--principle-component-analyses.html#cb408-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-6"><a href="week-6--principle-component-analyses.html#cb408-6" aria-hidden="true" tabindex="-1"></a>#we need to add our home directory to the path for pip</span>
<span id="cb408-7"><a href="week-6--principle-component-analyses.html#cb408-7" aria-hidden="true" tabindex="-1"></a>#look at path</span>
<span id="cb408-8"><a href="week-6--principle-component-analyses.html#cb408-8" aria-hidden="true" tabindex="-1"></a>echo $PATH</span>
<span id="cb408-9"><a href="week-6--principle-component-analyses.html#cb408-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-10"><a href="week-6--principle-component-analyses.html#cb408-10" aria-hidden="true" tabindex="-1"></a>#add the location of pip to our path</span>
<span id="cb408-11"><a href="week-6--principle-component-analyses.html#cb408-11" aria-hidden="true" tabindex="-1"></a>export PATH=&quot;$HOME/.local/bin:$PATH&quot;</span>
<span id="cb408-12"><a href="week-6--principle-component-analyses.html#cb408-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-13"><a href="week-6--principle-component-analyses.html#cb408-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-14"><a href="week-6--principle-component-analyses.html#cb408-14" aria-hidden="true" tabindex="-1"></a>#then install pcangsd</span>
<span id="cb408-15"><a href="week-6--principle-component-analyses.html#cb408-15" aria-hidden="true" tabindex="-1"></a>git clone https://github.com/Rosemeis/pcangsd.git</span>
<span id="cb408-16"><a href="week-6--principle-component-analyses.html#cb408-16" aria-hidden="true" tabindex="-1"></a>cd pcangsd/</span>
<span id="cb408-17"><a href="week-6--principle-component-analyses.html#cb408-17" aria-hidden="true" tabindex="-1"></a>python setup.py build_ext --inplace</span>
<span id="cb408-18"><a href="week-6--principle-component-analyses.html#cb408-18" aria-hidden="true" tabindex="-1"></a>pip3 install -e .</span></code></pre></div>
<p>Check that it’s installed correctly.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb409-1"><a href="week-6--principle-component-analyses.html#cb409-1" aria-hidden="true" tabindex="-1"></a>#navigate to your home directory</span>
<span id="cb409-2"><a href="week-6--principle-component-analyses.html#cb409-2" aria-hidden="true" tabindex="-1"></a>cd</span>
<span id="cb409-3"><a href="week-6--principle-component-analyses.html#cb409-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-4"><a href="week-6--principle-component-analyses.html#cb409-4" aria-hidden="true" tabindex="-1"></a>python3 pcangsd/pcangsd/pcangsd.py -h</span></code></pre></div>
<p>You should see the help menu for pcangsd.</p>
</div>
<div id="run-pcangsd-on-our-data" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Run pcangsd on our data<a href="week-6--principle-component-analyses.html#run-pcangsd-on-our-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In population genomics analyses we often use multiple programs, which often have different input file formats. This is again why writing out the input/output formats in a pipeline is very useful! Have a look at the <a href="http://www.popgen.dk/software/index.php/PCAngsd">pcangsd</a> website and see what type of input is needed.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb410-1"><a href="week-6--principle-component-analyses.html#cb410-1" aria-hidden="true" tabindex="-1"></a>cd</span>
<span id="cb410-2"><a href="week-6--principle-component-analyses.html#cb410-2" aria-hidden="true" tabindex="-1"></a>cd home/exouser/Week7</span>
<span id="cb410-3"><a href="week-6--principle-component-analyses.html#cb410-3" aria-hidden="true" tabindex="-1"></a>pcangsd --beagle /home/exouser/Week7/genolike_beagle.beagle.gz -o pca_out --threads 28</span>
<span id="cb410-4"><a href="week-6--principle-component-analyses.html#cb410-4" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<p>This will generate a covariance matrix output file (the "*.cov" file). We can read this file into R and compute the eigenvectors and eigenvalues and make our plot.</p>
</div>
<div id="setting-up-a-new-project-in-r" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Setting up a new project in R<a href="week-6--principle-component-analyses.html#setting-up-a-new-project-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll first open a new <code>.R</code> script to keep track of our code and everything that we’re doing. Be sure to comment heavily with <code>#</code>. It may seem obvious what we’re doing now, but you will forget what certain lines of code do in a surprisingly short amount of time.</p>
</div>
<div id="reading-data-into-r" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Reading data into R<a href="week-6--principle-component-analyses.html#reading-data-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are several ways to read data in R. Useful functions include <code>read.table()</code>, <code>getwd()</code>, and <code>setwd()</code></p>
<p>R like many other programs is set to start in a specific direcotory, usually the desktop or homw directory. You can check and see what directory R is set in with the command <code>getwd()</code></p>
<p>And of course all of this code is typed into our script and commented along the way.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="week-6--principle-component-analyses.html#cb411-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-2"><a href="week-6--principle-component-analyses.html#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="co">#check working directory</span></span>
<span id="cb411-3"><a href="week-6--principle-component-analyses.html#cb411-3" aria-hidden="true" tabindex="-1"></a><span class="co">#getwd()</span></span>
<span id="cb411-4"><a href="week-6--principle-component-analyses.html#cb411-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-5"><a href="week-6--principle-component-analyses.html#cb411-5" aria-hidden="true" tabindex="-1"></a><span class="co">#should output</span></span>
<span id="cb411-6"><a href="week-6--principle-component-analyses.html#cb411-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-7"><a href="week-6--principle-component-analyses.html#cb411-7" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] &quot;/home/exouser/Week7&quot;</span></span></code></pre></div>
<p>Thus in jetstream the working directory is set to our home directory, which will work fine for uploading data. If you need to change the directory you can use <code>setwd()</code> and provide it with the full directory path and then confirm that it moved the directory with <code>getwd()</code>.</p>
<p>In Rstudio you can also use the pull down menus <code>Session</code> to get and set your working directory. Similarly, the tab <code>Files</code> in the lower right will also allow you to set your working directory.</p>
<p>Now we’ll read the data output by angsd into R using <code>read.table()</code> and <code>as.matrix()</code></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="week-6--principle-component-analyses.html#cb412-1" aria-hidden="true" tabindex="-1"></a>cov<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">&quot;pca_out.cov&quot;</span>))</span></code></pre></div>
<p>And then we can compute the eigenvalues from our covariance matrix with the function <code>eigen</code>.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="week-6--principle-component-analyses.html#cb413-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-2"><a href="week-6--principle-component-analyses.html#cb413-2" aria-hidden="true" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="fu">eigen</span>(cov)</span></code></pre></div>
<p>And make a simple plot in base R</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="week-6--principle-component-analyses.html#cb414-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-2"><a href="week-6--principle-component-analyses.html#cb414-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-3"><a href="week-6--principle-component-analyses.html#cb414-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(e<span class="sc">$</span>vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div>
<p><img src="07-Week7.pca_files/figure-html/6-1-1.png" width="768" />
We may be interested in how much of the variance our first two components explain. You can look at this in the <code>e</code> object under values. We divide the eigen values by the sum of all the values to get the percent explained by each value.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="week-6--principle-component-analyses.html#cb415-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-2"><a href="week-6--principle-component-analyses.html#cb415-2" aria-hidden="true" tabindex="-1"></a>e<span class="sc">$</span>values<span class="sc">/</span><span class="fu">sum</span>(e<span class="sc">$</span>values)</span>
<span id="cb415-3"><a href="week-6--principle-component-analyses.html#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 0.24278761 0.07662213 0.07502757 0.07349541 0.07287943 0.07034540</span></span>
<span id="cb415-4"><a href="week-6--principle-component-analyses.html#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] 0.06674509 0.06530546 0.05280345 0.04958515 0.04274839 0.03706328</span></span>
<span id="cb415-5"><a href="week-6--principle-component-analyses.html#cb415-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] 0.03527164 0.03241500 0.00690499</span></span></code></pre></div>
<p>We now want to make the colors match population labels. The information on which population each individual sample came from is in the bam.filelist file (second column).</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="week-6--principle-component-analyses.html#cb416-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-2"><a href="week-6--principle-component-analyses.html#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the data</span></span>
<span id="cb416-3"><a href="week-6--principle-component-analyses.html#cb416-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-4"><a href="week-6--principle-component-analyses.html#cb416-4" aria-hidden="true" tabindex="-1"></a>names<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">&quot;bam.filelist&quot;</span>)</span>
<span id="cb416-5"><a href="week-6--principle-component-analyses.html#cb416-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-6"><a href="week-6--principle-component-analyses.html#cb416-6" aria-hidden="true" tabindex="-1"></a><span class="co">#assign the rownames of the covariance matix the </span></span>
<span id="cb416-7"><a href="week-6--principle-component-analyses.html#cb416-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-8"><a href="week-6--principle-component-analyses.html#cb416-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cov)<span class="ot">&lt;-</span>names<span class="sc">$</span>V2</span></code></pre></div>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="week-6--principle-component-analyses.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remake the plot with the colors we want</span></span>
<span id="cb417-2"><a href="week-6--principle-component-analyses.html#cb417-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-3"><a href="week-6--principle-component-analyses.html#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(e<span class="sc">$</span>vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col=</span><span class="fu">as.factor</span>(<span class="fu">rownames</span>(cov)), <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="07-Week7.pca_files/figure-html/6-2-1.png" width="768" /></p>
<p>There is another column in the bam.filelist file that will allow us to color the populations based on region (i.e. regions a or b). Go ahead and modify your plots to have nice x and y labels that state the percent variance explained by each axis, and that are colored by region. You can also change the pch and any other parameters you would like.</p>
</div>
<div id="group-exercises" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Group Exercises<a href="week-6--principle-component-analyses.html#group-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the following 2 exercises, we will again work in groups to re-create our PCAs, but with the stricter SNP filtering parameter of only allowing variant sites with data present for all 15 individuals.</p>
<p>Filtering genomic data is a bit of an art, as filtering more will allow for higher confidence in our SNPs, but will also likely lead us to remove true SNPs from the dataset thinking they are instead sequencing/mapping errors. Here, we are going to see if/how using a stricter filter changes our population structuring.</p>
<p>Start by creating a new R file (File -&gt; New File -&gt; R Script), save it as Week7.exercises.R. In this R file, write the code that you will use for each step of the exercises below. Make sure you use ‘#’ before each line of code explaining what you are doing (anottated code = happy coder)!</p>
<blockquote>
<p><strong>1.1</strong>) In R, upload the genotype likelihood maf file (genolike.beagle.maf.gz).</p>
</blockquote>
<blockquote>
<p>Hint: the read.table() command may give an error since the file is zipped. Google how to use the R command read.table() with a gzfile to read the ‘maf.gz’ file. We will also want to keep the first row as a header - google the command or type ‘?read.table’ into R to figure out how to keep the first line as variable names.</p>
</blockquote>
<blockquote>
<p>Explore this .maf file- what are the columns and rows telling us? Which column can tell us the number of individuals each SNP has data for?</p>
</blockquote>
<blockquote>
<p>Hint: have a look at <a href="http://www.popgen.dk/angsd/index.php/Allele_Frequencies">this webpage</a> to see the output format explanation</p>
</blockquote>
<blockquote>
<p><strong>1.2</strong>) Filter the data so that we only use sites in which all 15 individuals have data present (i.e., subset by the column of interest from 1.1). Save this filtered dataset as an object called “gen_filt.” How many SNPs does this leave us? How does it compare to the number of SNPs of the unfiltered dataset?</p>
</blockquote>
<blockquote>
<p>Hint: you can look at section 5.8 of week 4 on subsetting in R.</p>
</blockquote>
<blockquote>
<p><strong>2.1</strong>) Use the filtered file from exercise 1 in pcangsd to recalculate the covariance matrix and regenerate the pca plot. Can we use our gen_filt dataframe as an input file for pcangsd?</p>
</blockquote>
<blockquote>
<p>Read the original input file (genolike_beagle.beagle.gz) in R and see how the column names compare between it and our filtered .maf file.</p>
</blockquote>
<blockquote>
<p><strong>2.2</strong>) We see that we need to change the column names of gen_filt to match the beagle format. Here we can use the function <code>merge(x, y, by = )</code>. Again, you can use ‘?merge’ in R for more info on this command.</p>
</blockquote>
<blockquote>
<p>Note: the function merge only works (properly) if the column names are the same.</p>
</blockquote>
<blockquote>
<p>Change the column names to match across the two dataframes where they have the same info. To do this, first create a new column gen_filt called “marker,” where we will paste columns $chromo and $position as a single character separated by "_". Have a look <a href="https://www.marsja.se/how-to-concatenate-two-columns-or-more-in-r-stringr-tidyr/#:~:text=columns%20in%20R.-,How%20do%20I%20concatenate%20two%20columns%20in%20R%3F,B">here</a> on how to do this.</p>
</blockquote>
<blockquote>
<p>Then use merge command by the column “marker,” calling this new object ‘beag_filt.’ Check how many columns and rows are in this object.</p>
</blockquote>
<blockquote>
<p><strong>2.3</strong>) Pcangsd doesn’t want those extra columns that came from our merge lets get rid of them to leave the 48 columns that beagle needs. Use the “RC cola” notation to subset the dataframe, keeping only the first column and then columns 9-55.</p>
</blockquote>
<blockquote>
<p><strong>2.4</strong>) Use the “write.table” command to save our beagle file as the new input for pcangsd. Save the output as “geno_like_filt.beagle.”</p>
</blockquote>
<blockquote>
<p>Hint 1: By default write.table outputs a dataframe with row names, and we dont want that. Search how to have row names as False in the write.table command.</p>
</blockquote>
<blockquote>
<p>Hint 2: The beage file will also require columns being separated by tabs. Search how to tab separate write.table outputs, and include that as well in the command.</p>
</blockquote>
<blockquote>
<p><strong>2.5</strong>) We should now have our filtered beagle file in our R session directory. Let’s move back into terminal to run pcangsd again!</p>
</blockquote>
<blockquote>
<p>First gzip the file (‘gzip geno_like_filt.beagle’), then re-run the pcangsd command. Check your directories to make sure the input and output files are there.</p>
</blockquote>
<blockquote>
<p><strong>2.6</strong>) Then we can go back to R and rerun our code to calculate the eigenvalues and eigenvectors for this covariance matrix. How does the plot compare to the non-filtered dataset? How much of the variance do the first 2 PCs explain in this filtered dataset?</p>
</blockquote>
</div>
<div id="additional-exercise" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Additional Exercise<a href="week-6--principle-component-analyses.html#additional-exercise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Remake the base R plot that we generated in class in ggplot. Use the group parameter in aes to group by region and/or population. Note, ggplot wants the data to be a dataframe and our data is a matrix. Use the function <code>as.data.frame(e$vectors)</code> to acheive this in the ggplot function. Don’t forget to load the ggplot2 package with `library(ggplot2)’</p>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="week-6--principle-component-analyses.html#cb418-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-2"><a href="week-6--principle-component-analyses.html#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to use the function as.data.frame to make our matrix a dataframe.</span></span>
<span id="cb418-3"><a href="week-6--principle-component-analyses.html#cb418-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-4"><a href="week-6--principle-component-analyses.html#cb418-4" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(e<span class="sc">$</span>vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb418-5"><a href="week-6--principle-component-analyses.html#cb418-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-6"><a href="week-6--principle-component-analyses.html#cb418-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb418-7"><a href="week-6--principle-component-analyses.html#cb418-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>M, <span class="fu">aes</span>(<span class="at">y=</span>V1, <span class="at">x=</span>V2, <span class="at">group=</span><span class="fu">as.factor</span>(names<span class="sc">$</span>V3), <span class="at">color=</span><span class="fu">as.factor</span>(names<span class="sc">$</span>V3)))<span class="sc">+</span></span>
<span id="cb418-8"><a href="week-6--principle-component-analyses.html#cb418-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb418-9"><a href="week-6--principle-component-analyses.html#cb418-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb418-10"><a href="week-6--principle-component-analyses.html#cb418-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Region&quot;</span>, </span>
<span id="cb418-11"><a href="week-6--principle-component-analyses.html#cb418-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;North&quot;</span>, </span>
<span id="cb418-12"><a href="week-6--principle-component-analyses.html#cb418-12" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;South&quot;</span>), <span class="at">values =</span></span>
<span id="cb418-13"><a href="week-6--principle-component-analyses.html#cb418-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">&quot;a&quot;</span><span class="ot">=</span><span class="st">&quot;slateblue&quot;</span>, </span>
<span id="cb418-14"><a href="week-6--principle-component-analyses.html#cb418-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;b&quot;</span><span class="ot">=</span><span class="st">&quot;green&quot;</span>)) </span></code></pre></div>
<p><img src="07-Week7.pca_files/figure-html/7-3-1.png" width="768" /></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="week-6--principle-component-analyses.html#cb419-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2"><a href="week-6--principle-component-analyses.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="co">#read in genotype likelihood data and filter by all individuals</span></span>
<span id="cb419-3"><a href="week-6--principle-component-analyses.html#cb419-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4"><a href="week-6--principle-component-analyses.html#cb419-4" aria-hidden="true" tabindex="-1"></a>gen<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="fu">gzfile</span>(<span class="st">&quot;genolike_beagle.mafs.gz&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb419-5"><a href="week-6--principle-component-analyses.html#cb419-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6"><a href="week-6--principle-component-analyses.html#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="co">#filter by nind == 15</span></span>
<span id="cb419-7"><a href="week-6--principle-component-analyses.html#cb419-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-8"><a href="week-6--principle-component-analyses.html#cb419-8" aria-hidden="true" tabindex="-1"></a>gen_allIND<span class="ot">&lt;-</span>gen[gen<span class="sc">$</span>nInd<span class="sc">==</span><span class="dv">15</span>,]</span>
<span id="cb419-9"><a href="week-6--principle-component-analyses.html#cb419-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-10"><a href="week-6--principle-component-analyses.html#cb419-10" aria-hidden="true" tabindex="-1"></a><span class="co">#find how many SNPs we had in the first dataset</span></span>
<span id="cb419-11"><a href="week-6--principle-component-analyses.html#cb419-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-12"><a href="week-6--principle-component-analyses.html#cb419-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gen)</span>
<span id="cb419-13"><a href="week-6--principle-component-analyses.html#cb419-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 282950      7</span></span>
<span id="cb419-14"><a href="week-6--principle-component-analyses.html#cb419-14" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 282950      7</span></span>
<span id="cb419-15"><a href="week-6--principle-component-analyses.html#cb419-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-16"><a href="week-6--principle-component-analyses.html#cb419-16" aria-hidden="true" tabindex="-1"></a><span class="co">#how many do we have in the filtered dataset?</span></span>
<span id="cb419-17"><a href="week-6--principle-component-analyses.html#cb419-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-18"><a href="week-6--principle-component-analyses.html#cb419-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gen_allIND)</span>
<span id="cb419-19"><a href="week-6--principle-component-analyses.html#cb419-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 31905     7</span></span>
<span id="cb419-20"><a href="week-6--principle-component-analyses.html#cb419-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-21"><a href="week-6--principle-component-analyses.html#cb419-21" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 31905     7</span></span></code></pre></div>
</p>
</details>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="population-structure-via-construct.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MarGen2022.pdf", "MarGen2022.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
