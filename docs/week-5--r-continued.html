<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Week 5- R Continued | Week8_GWAS</title>
  <meta name="description" content="6 Week 5- R Continued | Week8_GWAS" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Week 5- R Continued | Week8_GWAS" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Week 5- R Continued | Week8_GWAS" />
  
  
  

<meta name="author" content="Serena Caplins" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4---the-r-environment.html"/>
<link rel="next" href="population-structure-via-construct.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Marine Genomics 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to Marine Genomics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#cloud-computing-versus-individual-laptops"><i class="fa fa-check"></i><b>1.1</b> Cloud computing versus individual laptops</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#meet-our-instructors"><i class="fa fa-check"></i><b>1.2</b> Meet our instructors!</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.3</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1--welcome.html"><a href="week-1--welcome.html"><i class="fa fa-check"></i><b>2</b> Week 1- Welcome!</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1--welcome.html"><a href="week-1--welcome.html#introduction-to-shell-computing-via-the-data-carpentry-tutorial"><i class="fa fa-check"></i><b>2.1</b> Introduction to shell computing via the data carpentry tutorial</a></li>
<li class="chapter" data-level="2.2" data-path="week-1--welcome.html"><a href="week-1--welcome.html#how-to-access-the-shell"><i class="fa fa-check"></i><b>2.2</b> How to access the shell</a></li>
<li class="chapter" data-level="2.3" data-path="week-1--welcome.html"><a href="week-1--welcome.html#best-practices-for-jetstream"><i class="fa fa-check"></i><b>2.3</b> Best practices for Jetstream</a></li>
<li class="chapter" data-level="2.4" data-path="week-1--welcome.html"><a href="week-1--welcome.html#week-1-objectives"><i class="fa fa-check"></i><b>2.4</b> Week 1 Objectives</a></li>
<li class="chapter" data-level="2.5" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-your-file-system"><i class="fa fa-check"></i><b>2.5</b> Navigating your file system</a></li>
<li class="chapter" data-level="2.6" data-path="week-1--welcome.html"><a href="week-1--welcome.html#shortcut-tab-completion"><i class="fa fa-check"></i><b>2.6</b> Shortcut: Tab Completion</a></li>
<li class="chapter" data-level="2.7" data-path="week-1--welcome.html"><a href="week-1--welcome.html#summary-key-points"><i class="fa fa-check"></i><b>2.7</b> Summary &amp; Key Points</a></li>
<li class="chapter" data-level="2.8" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-files-and-directories"><i class="fa fa-check"></i><b>2.8</b> Navigating Files and Directories</a></li>
<li class="chapter" data-level="2.9" data-path="week-1--welcome.html"><a href="week-1--welcome.html#moving-around-the-file-system"><i class="fa fa-check"></i><b>2.9</b> Moving around the file system</a></li>
<li class="chapter" data-level="2.10" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-practice-and-finding-hidden-directories"><i class="fa fa-check"></i><b>2.10</b> Navigating practice and finding hidden directories</a></li>
<li class="chapter" data-level="2.11" data-path="week-1--welcome.html"><a href="week-1--welcome.html#examining-the-contents-of-other-directories"><i class="fa fa-check"></i><b>2.11</b> Examining the contents of other directories</a></li>
<li class="chapter" data-level="2.12" data-path="week-1--welcome.html"><a href="week-1--welcome.html#full-vs-relative-paths"><i class="fa fa-check"></i><b>2.12</b> Full vs Relative Paths</a></li>
<li class="chapter" data-level="2.13" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigational-shortcuts"><i class="fa fa-check"></i><b>2.13</b> Navigational shortcuts</a></li>
<li class="chapter" data-level="2.14" data-path="week-1--welcome.html"><a href="week-1--welcome.html#key-points"><i class="fa fa-check"></i><b>2.14</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html"><i class="fa fa-check"></i><b>3</b> Week 2-Working With Files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#our-data-set-fastq-files"><i class="fa fa-check"></i><b>3.1</b> Our data set: FASTQ files</a></li>
<li class="chapter" data-level="3.2" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#wildcards"><i class="fa fa-check"></i><b>3.2</b> Wildcards</a></li>
<li class="chapter" data-level="3.3" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#command-history"><i class="fa fa-check"></i><b>3.3</b> Command History</a></li>
<li class="chapter" data-level="3.4" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#examining-files"><i class="fa fa-check"></i><b>3.4</b> Examining Files</a></li>
<li class="chapter" data-level="3.5" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#details-on-the-fastq-format"><i class="fa fa-check"></i><b>3.5</b> Details on the FASTQ format</a></li>
<li class="chapter" data-level="3.6" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#creating-moving-copying-and-removing"><i class="fa fa-check"></i><b>3.6</b> Creating, moving, copying, and removing</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#copying-files"><i class="fa fa-check"></i><b>3.6.1</b> Copying Files</a></li>
<li class="chapter" data-level="3.6.2" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#creating-directories"><i class="fa fa-check"></i><b>3.6.2</b> Creating Directories</a></li>
<li class="chapter" data-level="3.6.3" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#moving-renaming"><i class="fa fa-check"></i><b>3.6.3</b> Moving / Renaming</a></li>
<li class="chapter" data-level="3.6.4" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#file-permissions"><i class="fa fa-check"></i><b>3.6.4</b> File Permissions</a></li>
<li class="chapter" data-level="3.6.5" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#removing"><i class="fa fa-check"></i><b>3.6.5</b> Removing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#searching-within-editing-and-redirecting-files"><i class="fa fa-check"></i><b>3.7</b> Searching within, editing, and redirecting files</a></li>
<li class="chapter" data-level="3.8" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#searching-files"><i class="fa fa-check"></i><b>3.8</b> Searching files</a></li>
<li class="chapter" data-level="3.9" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#redirecting-output"><i class="fa fa-check"></i><b>3.9</b> Redirecting output</a></li>
<li class="chapter" data-level="3.10" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#writing-scripts-and-working-with-data"><i class="fa fa-check"></i><b>3.10</b> Writing Scripts and Working with Data</a></li>
<li class="chapter" data-level="3.11" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#writing-files"><i class="fa fa-check"></i><b>3.11</b> Writing files</a></li>
<li class="chapter" data-level="3.12" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#writing-scripts"><i class="fa fa-check"></i><b>3.12</b> Writing scripts</a></li>
<li class="chapter" data-level="3.13" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#computing-magic-with-for-loops"><i class="fa fa-check"></i><b>3.13</b> Computing magic with for loops</a></li>
<li class="chapter" data-level="3.14" data-path="week-2-working-with-files.html"><a href="week-2-working-with-files.html#using-basename-in-for-loops"><i class="fa fa-check"></i><b>3.14</b> Using Basename in for loops</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html"><i class="fa fa-check"></i><b>4</b> Week 3- What is a Genetic Variant?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#to-get-started-lets-dowload-the-data-and-install-a-few-programs"><i class="fa fa-check"></i><b>4.1</b> To get started lets dowload the data and install a few programs</a></li>
<li class="chapter" data-level="4.2" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#raw-read-quality-control"><i class="fa fa-check"></i><b>4.2</b> Raw read quality control</a></li>
<li class="chapter" data-level="4.3" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#trimming-to-remove-adapters"><i class="fa fa-check"></i><b>4.3</b> Trimming to remove adapters</a></li>
<li class="chapter" data-level="4.4" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#building-an-index-of-our-genome"><i class="fa fa-check"></i><b>4.4</b> Building an index of our genome</a></li>
<li class="chapter" data-level="4.5" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#map-reads-to-the-genome"><i class="fa fa-check"></i><b>4.5</b> Map reads to the genome</a></li>
<li class="chapter" data-level="4.6" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#sam-to-bam-file-conversion"><i class="fa fa-check"></i><b>4.6</b> sam to bam file conversion</a></li>
<li class="chapter" data-level="4.7" data-path="week-3--what-is-a-genetic-variant.html"><a href="week-3--what-is-a-genetic-variant.html#genotype-likelihoods"><i class="fa fa-check"></i><b>4.7</b> Genotype likelihoods</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html"><i class="fa fa-check"></i><b>5</b> Week 4 - The R environment</a>
<ul>
<li class="chapter" data-level="5.1" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#create-a-project-in-rstudio"><i class="fa fa-check"></i><b>5.1</b> Create a project in Rstudio</a></li>
<li class="chapter" data-level="5.2" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#orientation-to-r-studio"><i class="fa fa-check"></i><b>5.2</b> Orientation to R studio</a></li>
<li class="chapter" data-level="5.3" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#manipulating-a-vector-object"><i class="fa fa-check"></i><b>5.3</b> Manipulating a vector object</a></li>
<li class="chapter" data-level="5.4" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#characterizing-a-dataframe"><i class="fa fa-check"></i><b>5.4</b> Characterizing a dataframe</a></li>
<li class="chapter" data-level="5.5" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#how-to-access-parts-of-the-data"><i class="fa fa-check"></i><b>5.5</b> How to access parts of the data</a></li>
<li class="chapter" data-level="5.6" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#data-manipulation"><i class="fa fa-check"></i><b>5.6</b> Data Manipulation</a></li>
<li class="chapter" data-level="5.7" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#practice-exploring-a-dataframe"><i class="fa fa-check"></i><b>5.7</b> Practice exploring a dataframe</a></li>
<li class="chapter" data-level="5.8" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#subsetting-datasets-logicals"><i class="fa fa-check"></i><b>5.8</b> Subsetting datasets &amp; logicals</a></li>
<li class="chapter" data-level="5.9" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#practice-subsetting-datasetslogicals"><i class="fa fa-check"></i><b>5.9</b> Practice Subsetting datasets/logicals</a></li>
<li class="chapter" data-level="5.10" data-path="week-4---the-r-environment.html"><a href="week-4---the-r-environment.html#a-few-tips-for-coding-in-rstudio"><i class="fa fa-check"></i><b>5.10</b> A few tips for coding in Rstudio</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html"><i class="fa fa-check"></i><b>6</b> Week 5- R Continued</a>
<ul>
<li class="chapter" data-level="6.1" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#plotting"><i class="fa fa-check"></i><b>6.1</b> 2.1 Plotting</a></li>
<li class="chapter" data-level="6.2" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#scatterplots"><i class="fa fa-check"></i><b>6.2</b> Scatterplots</a></li>
<li class="chapter" data-level="6.3" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#customizing-your-plot"><i class="fa fa-check"></i><b>6.3</b> Customizing your plot</a></li>
<li class="chapter" data-level="6.4" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#histograms-and-box-plots"><i class="fa fa-check"></i><b>6.4</b> Histograms and box plots</a></li>
<li class="chapter" data-level="6.5" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#practice-problems-2.1"><i class="fa fa-check"></i><b>6.5</b> Practice Problems 2.1</a></li>
<li class="chapter" data-level="6.6" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>6.6</b> 2.2 plotting with ggplot2</a></li>
<li class="chapter" data-level="6.7" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#group-exercise-on-data-visualization"><i class="fa fa-check"></i><b>6.7</b> Group Exercise on Data Visualization</a></li>
<li class="chapter" data-level="6.8" data-path="week-5--r-continued.html"><a href="week-5--r-continued.html#practice-problems-2.2"><i class="fa fa-check"></i><b>6.8</b> Practice Problems 2.2</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html"><i class="fa fa-check"></i><b>7</b> Population Structure via conStruct</a>
<ul>
<li class="chapter" data-level="7.1" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#download-the-data"><i class="fa fa-check"></i><b>7.1</b> Download the data</a></li>
<li class="chapter" data-level="7.2" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#update-our-compiler-in-bashunix-and-install-everything-for-r-in-the-terminal-in-bashunix-not-in-rstudio"><i class="fa fa-check"></i><b>7.2</b> update our compiler in bash/UNIX and install everything for R in the terminal (in bash/UNIX, NOT in Rstudio)</a></li>
<li class="chapter" data-level="7.3" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#install-construct-in-r"><i class="fa fa-check"></i><b>7.3</b> install conStruct in R</a></li>
<li class="chapter" data-level="7.4" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#read-in-the-data"><i class="fa fa-check"></i><b>7.4</b> read in the data</a></li>
<li class="chapter" data-level="7.5" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#get-our-meta-data-read-into-r-and-ready-to-use"><i class="fa fa-check"></i><b>7.5</b> Get our meta data read into R and ready to use</a></li>
<li class="chapter" data-level="7.6" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#run-a-structure-analysis"><i class="fa fa-check"></i><b>7.6</b> Run a structure analysis</a></li>
<li class="chapter" data-level="7.7" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#incoorporate-geographic-distances-in-a-spatial-model"><i class="fa fa-check"></i><b>7.7</b> Incoorporate geographic distances in a spatial model</a></li>
<li class="chapter" data-level="7.8" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#comparisons-across-different-values-of-k"><i class="fa fa-check"></i><b>7.8</b> Comparisons across different values of K</a></li>
<li class="chapter" data-level="7.9" data-path="population-structure-via-construct.html"><a href="population-structure-via-construct.html#exercises"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html"><i class="fa fa-check"></i><b>8</b> Week 7 - Principle Component Analyses</a>
<ul>
<li class="chapter" data-level="8.1" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#download-the-data-1"><i class="fa fa-check"></i><b>8.1</b> Download the data</a></li>
<li class="chapter" data-level="8.2" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#installing-programs"><i class="fa fa-check"></i><b>8.2</b> Installing programs</a></li>
<li class="chapter" data-level="8.3" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#run-pcangsd-on-our-data"><i class="fa fa-check"></i><b>8.3</b> Run pcangsd on our data</a></li>
<li class="chapter" data-level="8.4" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#setting-up-a-new-project-in-r"><i class="fa fa-check"></i><b>8.4</b> Setting up a new project in R</a></li>
<li class="chapter" data-level="8.5" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#reading-data-into-r"><i class="fa fa-check"></i><b>8.5</b> Reading data into R</a></li>
<li class="chapter" data-level="8.6" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#group-exercises"><i class="fa fa-check"></i><b>8.6</b> Group Exercises</a></li>
<li class="chapter" data-level="8.7" data-path="week-7---principle-component-analyses.html"><a href="week-7---principle-component-analyses.html#additional-exercise"><i class="fa fa-check"></i><b>8.7</b> Additional Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html"><i class="fa fa-check"></i><b>9</b> Week 8- F<sub>st</sub> and outlier analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html#download-the-data-2"><i class="fa fa-check"></i><b>9.1</b> Download the data</a></li>
<li class="chapter" data-level="9.2" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html#getting-r-set-up"><i class="fa fa-check"></i><b>9.2</b> Getting R set up</a></li>
<li class="chapter" data-level="9.3" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html#finding-outliers-using-pcadapt"><i class="fa fa-check"></i><b>9.3</b> Finding outliers using pcadapt</a></li>
<li class="chapter" data-level="9.4" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html#pcadapt-exercises"><i class="fa fa-check"></i><b>9.4</b> pcadapt Exercises</a></li>
<li class="chapter" data-level="9.5" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html#using-fst-to-find-outliers"><i class="fa fa-check"></i><b>9.5</b> Using F<sub>st</sub> to find outliers</a></li>
<li class="chapter" data-level="9.6" data-path="week-8--fst-and-outlier-analysis.html"><a href="week-8--fst-and-outlier-analysis.html#outflank-practice"><i class="fa fa-check"></i><b>9.6</b> OutFLANK Practice</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html"><i class="fa fa-check"></i><b>10</b> Week 9: Genome wide association study (GWAS)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html#load-in-the-data"><i class="fa fa-check"></i><b>10.1</b> load in the data</a></li>
<li class="chapter" data-level="10.2" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html#install-packages-in-r"><i class="fa fa-check"></i><b>10.2</b> install packages in R</a></li>
<li class="chapter" data-level="10.3" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html#the-data"><i class="fa fa-check"></i><b>10.3</b> The data</a></li>
<li class="chapter" data-level="10.4" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html#take-beagle-file-and-generate-lrt-file"><i class="fa fa-check"></i><b>10.4</b> take Beagle file and generate lrt file</a></li>
<li class="chapter" data-level="10.5" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html#take-lrt-file-and-make-a-manhattan-plot"><i class="fa fa-check"></i><b>10.5</b> take lrt file and make a manhattan plot</a></li>
<li class="chapter" data-level="10.6" data-path="week-9-genome-wide-association-study-gwas.html"><a href="week-9-genome-wide-association-study-gwas.html#exercises-1"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Week8_GWAS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-5--r-continued" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Week 5- R Continued<a href="week-5--r-continued.html#week-5--r-continued" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We’re again drawing some of this material from the STEMinist_R materials which can be found <a href="https://github.com/ecalfee/STEMinist_R.git">here</a></p>
<p>This class will take place with students typing directly into an R script for the exercises all of which can be found in the Week 5 file <a href="https://github.com/BayLab/MarineGenomicsData.git">here</a></p>
<p>You can download just the R files for just this week via wget with the following link</p>
<pre class="{html"><code>wget https://raw.githubusercontent.com/BayLab/MarineGenomicsData/main/week5.tar.gz</code></pre>
<p>this is a compressed file which can be uncompressed via:</p>
<pre><code>tar -xzvf week5.tar.gz</code></pre>
<div id="plotting" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 2.1 Plotting<a href="week-5--r-continued.html#plotting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plots are very useful to help us understand our data and test hypotheses. Usually a plot or graph will visually display the relationship between two or more <strong>variables</strong>. Variables can be continuous, such as the number of cats, or categorical, such as the type of cat.</p>
<ul>
<li>A few useful commands that we will cover include:
<ul>
<li>points()</li>
<li>lines()</li>
<li>abline()</li>
<li>hist()</li>
<li>boxplot()</li>
<li>plot()
<ul>
<li>A few useful arguments within plot(): main, xlab, ylab, col, pch, cex</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="scatterplots" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Scatterplots<a href="week-5--r-continued.html#scatterplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Scatterplots are useful when we have <strong>continuous variables</strong>, and want to assess the relationship between them. Usually we will have a predictor or independent variable, which we think has an influence on the other variable, called the response or dependent variable.</p>
<p>Within our <code>msleep</code> dataframe let’s plot sleep_total by sleep_rem. Here we expect the total number of hours sleeping to have an effect on the total hours of REM, or dreaming, sleep.</p>
<p> </p>
<p>First install the package ‘ggplot2,’ then run the following:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="week-5--r-continued.html#cb357-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-2"><a href="week-5--r-continued.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb357-3"><a href="week-5--r-continued.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(msleep)</span></code></pre></div>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="week-5--r-continued.html#cb358-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-2"><a href="week-5--r-continued.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total, msleep<span class="sc">$</span>sleep_rem)</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-1-1.png" width="768" /></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="week-5--r-continued.html#cb359-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-2"><a href="week-5--r-continued.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or plot response variable as a function &quot;~&quot; of the predictor variable. When we use ~, the dependent variable is always on the left hand side. </span></span></code></pre></div>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="week-5--r-continued.html#cb360-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-2"><a href="week-5--r-continued.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span>msleep<span class="sc">$</span>sleep_rem) <span class="co">#you&#39;ll notice this swaps the x and y axis</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-2-1.png" width="768" /></p>
<p>From looking at this plot, does it look like there’s a relationship between hours of sleep and hours of REM? What does each point represent on these graphs?</p>
<p>Also, note that plots generally show the independent “cause” variable on the x-axis, and the dependent or “effect” variable on the y.</p>
<p> </p>
</div>
<div id="customizing-your-plot" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Customizing your plot<a href="week-5--r-continued.html#customizing-your-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>There are several different arguments within plotting functions that can be used to customize your plot.
<ul>
<li><code>col</code> changes color</li>
<li><code>pch</code> changes point character</li>
<li><code>cex</code> changes size</li>
<li><code>type</code> changes type (“l” = line, “p” = points, “b” = both)</li>
<li><code>lty</code> changes line type</li>
<li><code>bty</code> changes (or removes) the border around the plot (“n” = no box, “7” = top + right, “L” = bottom+left, “C” top+left+bottom, “U” = left+bottom+right)</li>
</ul></li>
</ul>
<p>You can view different point characters with <code>?pch</code></p>
<p>There are <strong>many</strong> color options in R. For some general colors you can write the name (blue, red, green, etc). There are apparently 657 named colors in R (including “slateblue3,” and “peachpuff4”) but you can also use the color hexidecimal code for a given color. There are several comprehensives guides for colors in R online and one of which can be found <a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf">here</a></p>
<p> </p>
<p>Let’s remake the total_sleep against sleep_rem plot and add-in some modifiers</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="week-5--r-continued.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Choose a pch and make the color blue and give it a bottom+left border</span></span>
<span id="cb361-2"><a href="week-5--r-continued.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span>msleep<span class="sc">$</span>sleep_rem, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">bty=</span><span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-3-1.png" width="768" /></p>
<p>We can change the axes and title labels using “xlab,” “ylab,” and “main” arguments. Let’s add labels to our plot.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="week-5--r-continued.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Choose a pch and make the color blue and give it a bottom+left border</span></span>
<span id="cb362-2"><a href="week-5--r-continued.html#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span>msleep<span class="sc">$</span>sleep_rem, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">bty=</span><span class="st">&quot;L&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;REM Sleep (hours)&quot;</span>, <span class="at">ylab=</span> <span class="st">&quot;Total Sleep (hours)&quot;</span>) </span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-4-1.png" width="768" /></p>
<p> </p>
<p>We can also add lines to an existing plot with <code>ablines()</code>. Let’s add a line fit from a linear model to our plot.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="week-5--r-continued.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first make a plot</span></span>
<span id="cb363-2"><a href="week-5--r-continued.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span>msleep<span class="sc">$</span>sleep_rem, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">bty=</span><span class="st">&quot;L&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;REM Sleep (hours)&quot;</span>, <span class="at">ylab=</span> <span class="st">&quot;Total Sleep (hours)&quot;</span>) </span>
<span id="cb363-3"><a href="week-5--r-continued.html#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="week-5--r-continued.html#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co">#then add a line. The function lm runs a linear model on our x, y values.</span></span>
<span id="cb363-5"><a href="week-5--r-continued.html#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span>msleep<span class="sc">$</span>sleep_rem))</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-5-1.png" width="768" /></p>
<p> </p>
<p>This adds a line of best fit, that minimizes the distance of those points from that line. These lines help us assess the overall pattern in the data. From the points and the line, does it look like there is a correlation?</p>
<p>You can add a legend to a plot with <code>legend()</code> which needs you to specify the location.</p>
<p>To do this, let’s make a cutoff for our points and color them by points above and below the cutoff. We’ll use our subsetting skills from last week. Feel free to review that section (5.8).</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="week-5--r-continued.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co">#start by defining points by whether they are greater than sleep_total 16 and storing</span></span>
<span id="cb364-2"><a href="week-5--r-continued.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="co">#first make a empty column named colors within the msleep dataframe</span></span>
<span id="cb364-3"><a href="week-5--r-continued.html#cb364-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-4"><a href="week-5--r-continued.html#cb364-4" aria-hidden="true" tabindex="-1"></a>msleep<span class="sc">$</span>colors<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb364-5"><a href="week-5--r-continued.html#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co">#store the colors &quot;red&quot; or &quot;black&quot; in the color column for the rows that satsify the following criteria.</span></span>
<span id="cb364-6"><a href="week-5--r-continued.html#cb364-6" aria-hidden="true" tabindex="-1"></a>msleep<span class="sc">$</span>colors[msleep<span class="sc">$</span>sleep_total <span class="sc">&gt;=</span> <span class="dv">17</span>] <span class="ot">&lt;-</span><span class="st">&quot;red&quot;</span></span>
<span id="cb364-7"><a href="week-5--r-continued.html#cb364-7" aria-hidden="true" tabindex="-1"></a>msleep<span class="sc">$</span>colors[msleep<span class="sc">$</span>sleep_total <span class="sc">&lt;</span> <span class="dv">17</span>] <span class="ot">&lt;-</span><span class="st">&quot;black&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="week-5--r-continued.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span>msleep<span class="sc">$</span>sleep_rem, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col=</span>msleep<span class="sc">$</span>colors, <span class="at">bty=</span><span class="st">&quot;L&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;REM Sleep (hours)&quot;</span>, <span class="at">ylab=</span> <span class="st">&quot;Total Sleep (hours)&quot;</span>) </span>
<span id="cb365-2"><a href="week-5--r-continued.html#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="week-5--r-continued.html#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;&gt;=17hrs&quot;</span>, <span class="st">&quot;&lt;17hrs&quot;</span>),</span>
<span id="cb365-4"><a href="week-5--r-continued.html#cb365-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-6-1.png" width="768" /></p>
<p> </p>
</div>
<div id="histograms-and-box-plots" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Histograms and box plots<a href="week-5--r-continued.html#histograms-and-box-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to scatter plots you can make histograms and box plots in base R. Boxplots and histograms both include a <strong>continuous variable</strong> and a <strong>categorical variable</strong>.</p>
<p>Histograms are appropriate for counts, whereas box plots should be used to represent the characteristics of a distribution.</p>
<p>Histograms are often used to assess the distribution of the data, and can be helpful when you want to assess the sums of a continuous variable within each group.</p>
<p>Box plots are helpful when we want to compare the means and variation of values between groups. Box plots graphically represent the five most important descriptive values for a data set: the minimum value, the first quartile, the median, the third quartile, and the maximum value.</p>
<p>The same parameter options (pch, col, ylab, xlab, etc) apply for these plots as well as scatterplots.</p>
<p>R will automatically plot a barplot if you give to the <code>plot()</code> function a continuous variable and a factor. If you have a vector stored as a character converting it to a factor via <code>as.factor</code> will make a boxplot.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="week-5--r-continued.html#cb366-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-2"><a href="week-5--r-continued.html#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="co">#let&#39;s make a histogram of sleep_total and fill it with the color palette rainbow() which needs to know how many colors to use</span></span>
<span id="cb366-3"><a href="week-5--r-continued.html#cb366-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-4"><a href="week-5--r-continued.html#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(msleep<span class="sc">$</span>sleep_total, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">10</span>))</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-7-1.png" width="768" />
A quick glance at this histogram tells us that our sleep_total variable looks relatively normally distributed. This is important to know for many statistical tests.</p>
<p> </p>
<p>Let’s try making a box plot, comparing the amount and variation in amount of sleep across the different biological orders (how would you find out how many unique orders are in msleep?)</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="week-5--r-continued.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co">#let&#39;s make a boxplot of sleep_total and order making each one a different color </span></span>
<span id="cb367-2"><a href="week-5--r-continued.html#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="co">#using plot it would look like the following (code is silenced as it give same plot as below):</span></span>
<span id="cb367-3"><a href="week-5--r-continued.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="week-5--r-continued.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(msleep$sleep_total~as.factor(msleep$order), col=rainbow(19)) </span></span>
<span id="cb367-5"><a href="week-5--r-continued.html#cb367-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-6"><a href="week-5--r-continued.html#cb367-6" aria-hidden="true" tabindex="-1"></a><span class="co">#or we can do the following:</span></span>
<span id="cb367-7"><a href="week-5--r-continued.html#cb367-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span><span class="fu">as.factor</span>(msleep<span class="sc">$</span>order), <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">19</span>)) </span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-8-1.png" width="768" /></p>
<p>One thing to note is that most plots in R will order factors in alphabetical order. And if axis label names are long, the names might not all be shown (as on the x-axis on the plot above), or the labels might overlap. There are many ways to edit the axes to counter each of these things, which can be searched online.</p>
<p> </p>
<p>Another example looking at sleep variation across the different types of consumers (carnivore, herbivore, insectivore and omnivore):</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="week-5--r-continued.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(msleep<span class="sc">$</span>sleep_total<span class="sc">~</span><span class="fu">as.factor</span>(msleep<span class="sc">$</span>vore),<span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">4</span>), <span class="at">xlab=</span><span class="st">&quot;Consumer type&quot;</span>, <span class="at">ylab=</span> <span class="st">&quot;Total Sleep (hours)&quot;</span>)</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-9-1.png" width="768" /></p>
<p>Which type of consumer shows the least variation in hours the species within it sleep?</p>
</div>
<div id="practice-problems-2.1" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Practice Problems 2.1<a href="week-5--r-continued.html#practice-problems-2.1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<h1 id="exercise-2.1" class="hasAnchor">Exercise 2.1<a href="week-5--r-continued.html#exercise-2.1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here we are interested in understanding the effect of different diets on the growth of baby chicks. The following exercises will help us test our hypothesis that diet type will lead to differences in growth, via chick weight.</p>
<p>Read in the data using <code>data(ChickWeight)</code></p>
</blockquote>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="week-5--r-continued.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: this dataset can also be accessed directly from the ChickWeight package in R </span></span>
<span id="cb369-2"><a href="week-5--r-continued.html#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (see ?ChickWeight)</span></span>
<span id="cb369-3"><a href="week-5--r-continued.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ChickWeight&quot;</span>)</span></code></pre></div>
<blockquote>
<ol style="list-style-type: decimal">
<li>First, explore the data.
How many chicks are in the dataset?
How many different diets are in the experiment?</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="week-5--r-continued.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(ChickWeight<span class="sc">$</span>Chick))</span>
<span id="cb370-2"><a href="week-5--r-continued.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 50</span></span>
<span id="cb370-3"><a href="week-5--r-continued.html#cb370-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(ChickWeight<span class="sc">$</span>Diet))</span>
<span id="cb370-4"><a href="week-5--r-continued.html#cb370-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4</span></span></code></pre></div>
</p>
</details>
<blockquote>
<ol start="2" style="list-style-type: decimal">
<li>To vizualize the basics of the data, plot weight versus time.</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="week-5--r-continued.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ChickWeight<span class="sc">$</span>weight <span class="sc">~</span> ChickWeight<span class="sc">$</span>Time, </span>
<span id="cb371-2"><a href="week-5--r-continued.html#cb371-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, </span>
<span id="cb371-3"><a href="week-5--r-continued.html#cb371-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Weight (gm)&quot;</span>)</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-10-1.png" width="768" />
Does it look like there is a change in chick weight over time? Does that change differ across chicks?</p>
</p>
</details>
<blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Plot a histogram of the weights of the chicks at the final day of the experiments (i.e. only the chicks who made it to the last day).</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="week-5--r-continued.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ChickWeight<span class="sc">$</span>weight[ChickWeight<span class="sc">$</span>Time <span class="sc">==</span> <span class="fu">max</span>(ChickWeight<span class="sc">$</span>Time)], </span>
<span id="cb372-2"><a href="week-5--r-continued.html#cb372-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Weight (gm)&quot;</span>, </span>
<span id="cb372-3"><a href="week-5--r-continued.html#cb372-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Weights at final day of experiment&quot;</span>, </span>
<span id="cb372-4"><a href="week-5--r-continued.html#cb372-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">10</span>))</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-11-1.png" width="768" />
What does this tell us about the distribution of the data?</p>
</p>
</details>
<blockquote>
<ol start="4" style="list-style-type: decimal">
<li>Create a boxplot where the x-axis represents the different diets and the y-axis is the weights of the chicks at the final day of the experiments.</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="week-5--r-continued.html#cb373-1" aria-hidden="true" tabindex="-1"></a>my.new <span class="ot">=</span> ChickWeight[ChickWeight<span class="sc">$</span>Time <span class="sc">==</span> <span class="fu">max</span>(ChickWeight<span class="sc">$</span>Time), ]</span>
<span id="cb373-2"><a href="week-5--r-continued.html#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> Diet, </span>
<span id="cb373-3"><a href="week-5--r-continued.html#cb373-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> my.new, </span>
<span id="cb373-4"><a href="week-5--r-continued.html#cb373-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Diet&quot;</span>, </span>
<span id="cb373-5"><a href="week-5--r-continued.html#cb373-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Weight (gm)&quot;</span>, </span>
<span id="cb373-6"><a href="week-5--r-continued.html#cb373-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Final weights given diet type&quot;</span>, </span>
<span id="cb373-7"><a href="week-5--r-continued.html#cb373-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-12-1.png" width="768" />
From this plot, do you think it’s reasonable to assume that our hypothesis is correct (that diet affects weight)? If so, which diet leads to the highest growth in chicks?</p>
</p>
</details>
<blockquote>
<p>Try using the package R Color Brewer to generate color palettes. Go to <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org/</a> to vizualize palettes. You can choose palettes that are colorblind safe, print friendly, etc.</p>
</blockquote>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="week-5--r-continued.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install R Color Brewer</span></span>
<span id="cb374-2"><a href="week-5--r-continued.html#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;RColorBrewer&quot;)</span></span>
<span id="cb374-3"><a href="week-5--r-continued.html#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;RColorBrewer&quot;</span>)</span></code></pre></div>
<blockquote>
<ol start="4" style="list-style-type: decimal">
<li>Define a color pallete with 10 colors and re-plot the histogram of the weights of the chicks at the final day of the experiments in these colors
Note: if histogram has n breaks and n is less than 10, it will just use first n colors. If n is greater than 10, it will reuse colors.</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="week-5--r-continued.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb375-2"><a href="week-5--r-continued.html#cb375-2" aria-hidden="true" tabindex="-1"></a>my.colors <span class="ot">=</span> <span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="st">&quot;Paired&quot;</span>)</span>
<span id="cb375-3"><a href="week-5--r-continued.html#cb375-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ChickWeight<span class="sc">$</span>weight[ChickWeight<span class="sc">$</span>Time <span class="sc">==</span> <span class="fu">max</span>(ChickWeight<span class="sc">$</span>Time)], <span class="at">xlab =</span> <span class="st">&quot;Weight (gm)&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Weights at final day of experiment&quot;</span>, <span class="at">col =</span> my.colors)</span></code></pre></div>
<img src="05-Week5_R_Introduction_continued_files/figure-html/5-13-1.png" width="768" />
</p>
</details>
</div>
<div id="plotting-with-ggplot2" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> 2.2 plotting with ggplot2<a href="week-5--r-continued.html#plotting-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>GGPlot is a package that allows you to make a lot of different kinds of plots and has become increasingly popular. There are also many tutorials on how to use ggplot as well as example code that could be modified to fit the data you’re interested in plotting. There is a really helpful cheatsheat (here)[<a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf</a>]</p>
<p>There is a little bit of a learning curve for ggplot as the syntax is structured differently than base R plotting. One thing that remains the same and is even more noticible in ggplot is the iterative process of building a plot, one aspect at a time.</p>
<p>Let’s demonstrate what ggplot can do with the states data set</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="week-5--r-continued.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in the data</span></span>
<span id="cb376-2"><a href="week-5--r-continued.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(state)</span>
<span id="cb376-3"><a href="week-5--r-continued.html#cb376-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">=</span> <span class="fu">as.data.frame</span>(state.x77) <span class="co"># convert data to a familiar format - data frame</span></span>
<span id="cb376-4"><a href="week-5--r-continued.html#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(states) <span class="co"># let&#39;s take a look at the dataframe</span></span>
<span id="cb376-5"><a href="week-5--r-continued.html#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    50 obs. of  8 variables:</span></span>
<span id="cb376-6"><a href="week-5--r-continued.html#cb376-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Population: num  3615 365 2212 2110 21198 ...</span></span>
<span id="cb376-7"><a href="week-5--r-continued.html#cb376-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Income    : num  3624 6315 4530 3378 5114 ...</span></span>
<span id="cb376-8"><a href="week-5--r-continued.html#cb376-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Illiteracy: num  2.1 1.5 1.8 1.9 1.1 0.7 1.1 0.9 1.3 2 ...</span></span>
<span id="cb376-9"><a href="week-5--r-continued.html#cb376-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Life Exp  : num  69 69.3 70.5 70.7 71.7 ...</span></span>
<span id="cb376-10"><a href="week-5--r-continued.html#cb376-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Murder    : num  15.1 11.3 7.8 10.1 10.3 6.8 3.1 6.2 10.7 13.9 ...</span></span>
<span id="cb376-11"><a href="week-5--r-continued.html#cb376-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ HS Grad   : num  41.3 66.7 58.1 39.9 62.6 63.9 56 54.6 52.6 40.6 ...</span></span>
<span id="cb376-12"><a href="week-5--r-continued.html#cb376-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Frost     : num  20 152 15 65 20 166 139 103 11 60 ...</span></span>
<span id="cb376-13"><a href="week-5--r-continued.html#cb376-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Area      : num  50708 566432 113417 51945 156361 ...</span></span>
<span id="cb376-14"><a href="week-5--r-continued.html#cb376-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-15"><a href="week-5--r-continued.html#cb376-15" aria-hidden="true" tabindex="-1"></a><span class="co">#make an initial ggplot</span></span>
<span id="cb376-16"><a href="week-5--r-continued.html#cb376-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>states) </span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-14-1.png" width="768" /></p>
<p>We just see a grey box. In order to tell ggplot what to put in the box we use the <code>aes()</code>. The <code>aes()</code> function stands for aesthetics and will be used to specify our axes and how we want the data grouped.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="week-5--r-continued.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lets make a scatterplot of population and income</span></span>
<span id="cb377-2"><a href="week-5--r-continued.html#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="co">#we specify which axes we want to be x and y with aes()</span></span>
<span id="cb377-3"><a href="week-5--r-continued.html#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="co">#we&#39;ll then use geom_point to tell it to make a scatterplot using the data we specified in the first command</span></span>
<span id="cb377-4"><a href="week-5--r-continued.html#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>states, <span class="fu">aes</span>(<span class="at">x=</span>Population, <span class="at">y=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-15-1.png" width="768" /></p>
<p>There are many types of plots in ggplot that can be called with <code>geom_</code> including <code>geom_line</code>, <code>geom_boxplot</code> <code>geom_bar</code> and many others!</p>
<p>Let’s add a line to our plot that of best fit for Population ~ Income. Each time we add something to our plot we use the <code>+</code> sign. We’ll use <code>geom_smooth()</code> to draw a line with the method for <code>lm</code> which stands for linear model.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="week-5--r-continued.html#cb378-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-2"><a href="week-5--r-continued.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>states, <span class="fu">aes</span>(<span class="at">x=</span>Population, <span class="at">y=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) </span>
<span id="cb378-3"><a href="week-5--r-continued.html#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-16-1.png" width="768" /></p>
<p>As you can already see ggplot works with many more parameters drawn in default than plotting in base R. For example, the background of our plot is grey the confidence interval of our line is drawn for us and is shaded dark grey and the line of best fit is in blue. All of these things can be modified if we wish. Many of these options can easily be changed with the <code>theme_</code> functions.</p>
<p>Let’s change to a minimal theme which removes the gray backgroun in the back of the plot. Play around with the other themes to see what they change.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="week-5--r-continued.html#cb379-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-2"><a href="week-5--r-continued.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>states, <span class="fu">aes</span>(<span class="at">x=</span>Population, <span class="at">y=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>() </span>
<span id="cb379-3"><a href="week-5--r-continued.html#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-17-1.png" width="768" /></p>
<p>Another plot example, looking at the relationship between Income and Illiteracy, colored by the population size.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="week-5--r-continued.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>states, <span class="fu">aes</span>(<span class="at">x=</span>Income, <span class="at">y=</span>Illiteracy, <span class="at">color=</span>Population)) <span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span><span class="fu">theme_classic</span>() </span>
<span id="cb380-2"><a href="week-5--r-continued.html#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-18-1.png" width="768" />
Looking at this plot, what is it telling us? Is there anything you would change to assess the data better?</p>
<p>Let’s use the <code>msleep</code> data set to explore what ggplot can do with character vectors. Make a plot of total sleep against REM sleep and then group by “vore.”</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="week-5--r-continued.html#cb381-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-2"><a href="week-5--r-continued.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="co"># because our vore vector is a character vector we must convert it to a factor before we can use it to group or color</span></span>
<span id="cb381-3"><a href="week-5--r-continued.html#cb381-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-4"><a href="week-5--r-continued.html#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep, <span class="fu">aes</span>(<span class="at">y=</span>sleep_total, <span class="at">x=</span>sleep_rem, <span class="at">group=</span><span class="fu">as.factor</span>(vore), <span class="at">color=</span><span class="fu">as.factor</span>(vore))) <span class="sc">+</span><span class="fu">geom_point</span>()</span>
<span id="cb381-5"><a href="week-5--r-continued.html#cb381-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 22 rows containing missing values (geom_point).</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-19-1.png" width="768" /></p>
<p>That looks fine, but we may want to add axis labels and change the legend. The code below does just that and changes the theme.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="week-5--r-continued.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as we add things to the plot the line can get really long, you can hit enter after the plus sign to start a new line</span></span>
<span id="cb382-2"><a href="week-5--r-continued.html#cb382-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-3"><a href="week-5--r-continued.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep, <span class="fu">aes</span>(<span class="at">y=</span>sleep_total, <span class="at">x=</span>sleep_rem, <span class="at">group=</span><span class="fu">as.factor</span>(vore), <span class="at">color=</span><span class="fu">as.factor</span>(vore)))<span class="sc">+</span></span>
<span id="cb382-4"><a href="week-5--r-continued.html#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb382-5"><a href="week-5--r-continued.html#cb382-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span> <span class="st">&quot;Total Sleep (hours)&quot;</span>, <span class="at">x=</span> <span class="st">&quot;REM sleep (hours)&quot;</span>)<span class="sc">+</span></span>
<span id="cb382-6"><a href="week-5--r-continued.html#cb382-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb382-7"><a href="week-5--r-continued.html#cb382-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Diet&quot;</span>, </span>
<span id="cb382-8"><a href="week-5--r-continued.html#cb382-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Carnivore&quot;</span>, </span>
<span id="cb382-9"><a href="week-5--r-continued.html#cb382-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Herbivore&quot;</span>, </span>
<span id="cb382-10"><a href="week-5--r-continued.html#cb382-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Insectivore&quot;</span>, </span>
<span id="cb382-11"><a href="week-5--r-continued.html#cb382-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Omnivore&quot;</span>, </span>
<span id="cb382-12"><a href="week-5--r-continued.html#cb382-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;NA&quot;</span>), </span>
<span id="cb382-13"><a href="week-5--r-continued.html#cb382-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;carni&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>, </span>
<span id="cb382-14"><a href="week-5--r-continued.html#cb382-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;herbi&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb382-15"><a href="week-5--r-continued.html#cb382-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;insecti&quot;</span><span class="ot">=</span><span class="st">&quot;green&quot;</span>, </span>
<span id="cb382-16"><a href="week-5--r-continued.html#cb382-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;omni&quot;</span><span class="ot">=</span><span class="st">&quot;brown&quot;</span>, </span>
<span id="cb382-17"><a href="week-5--r-continued.html#cb382-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;NA&quot;</span><span class="ot">=</span><span class="st">&quot;orange&quot;</span>))</span>
<span id="cb382-18"><a href="week-5--r-continued.html#cb382-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 22 rows containing missing values (geom_point).</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-20-1.png" width="768" />
Our plot at this point is getting very clunky. You can assign what we have so far to an object and continue to add parameters without having to copy and paste the whole plot.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="week-5--r-continued.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assign to an object</span></span>
<span id="cb383-2"><a href="week-5--r-continued.html#cb383-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-3"><a href="week-5--r-continued.html#cb383-3" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="fu">ggplot</span>(msleep, <span class="fu">aes</span>(<span class="at">y=</span>sleep_total, <span class="at">x=</span>sleep_rem, <span class="at">group=</span><span class="fu">as.factor</span>(vore), <span class="at">color=</span><span class="fu">as.factor</span>(vore)))<span class="sc">+</span></span>
<span id="cb383-4"><a href="week-5--r-continued.html#cb383-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb383-5"><a href="week-5--r-continued.html#cb383-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span> <span class="st">&quot;Total Sleep (hours)&quot;</span>, <span class="at">x=</span> <span class="st">&quot;REM sleep (hours)&quot;</span>)<span class="sc">+</span></span>
<span id="cb383-6"><a href="week-5--r-continued.html#cb383-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb383-7"><a href="week-5--r-continued.html#cb383-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Diet&quot;</span>, </span>
<span id="cb383-8"><a href="week-5--r-continued.html#cb383-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Carnivore&quot;</span>, </span>
<span id="cb383-9"><a href="week-5--r-continued.html#cb383-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Herbivore&quot;</span>, </span>
<span id="cb383-10"><a href="week-5--r-continued.html#cb383-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Insectivore&quot;</span>, </span>
<span id="cb383-11"><a href="week-5--r-continued.html#cb383-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Omnivore&quot;</span>, </span>
<span id="cb383-12"><a href="week-5--r-continued.html#cb383-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;NA&quot;</span>), </span>
<span id="cb383-13"><a href="week-5--r-continued.html#cb383-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;carni&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>, </span>
<span id="cb383-14"><a href="week-5--r-continued.html#cb383-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;herbi&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb383-15"><a href="week-5--r-continued.html#cb383-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;insecti&quot;</span><span class="ot">=</span><span class="st">&quot;green&quot;</span>, </span>
<span id="cb383-16"><a href="week-5--r-continued.html#cb383-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;omni&quot;</span><span class="ot">=</span><span class="st">&quot;brown&quot;</span>, </span>
<span id="cb383-17"><a href="week-5--r-continued.html#cb383-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;NA&quot;</span><span class="ot">=</span><span class="st">&quot;orange&quot;</span>))</span>
<span id="cb383-18"><a href="week-5--r-continued.html#cb383-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-19"><a href="week-5--r-continued.html#cb383-19" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb383-20"><a href="week-5--r-continued.html#cb383-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 22 rows containing missing values (geom_point).</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-21-1.png" width="768" />
This example is a great way to begin to explore how the relationship between total sleep and REM sleep varies across species with different diets, but overall still shows the correlation at the whole group level.</p>
<p>If we want to dive deeper and compare the relationship between two continuous variables, and how that relationship differs between groups/characters, we can use whats called a ‘facet wrap.’</p>
<p>For example in the iris dataframe we may be interested in looking at the relationship between Sepal.Length and Sepal.Width for each species. You can look at all of these together with <code>facet_wrap</code> or <code>facet_grid</code>.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="week-5--r-continued.html#cb384-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-2"><a href="week-5--r-continued.html#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">y=</span>Sepal.Length, <span class="at">x=</span>Sepal.Width, <span class="at">group=</span>Species, <span class="at">color=</span>Species))<span class="sc">+</span></span>
<span id="cb384-3"><a href="week-5--r-continued.html#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb384-4"><a href="week-5--r-continued.html#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species)<span class="sc">+</span></span>
<span id="cb384-5"><a href="week-5--r-continued.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)</span>
<span id="cb384-6"><a href="week-5--r-continued.html#cb384-6" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-22-1.png" width="768" />
How does the relationship between sepal width and length differ between the three species?</p>
<p> </p>
<p>Finally in ggplot we may be interested in seeing the mean values plotted with error bars for several groups. You can use the function <code>stat_summary</code> to find the mean and error around that mean for the given grouping.</p>
<p>Here’s a plot looking at the mean chickweight by diet.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="week-5--r-continued.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">group=</span>Diet, <span class="at">color=</span>Diet))<span class="sc">+</span></span>
<span id="cb385-2"><a href="week-5--r-continued.html#cb385-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb385-3"><a href="week-5--r-continued.html#cb385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb385-4"><a href="week-5--r-continued.html#cb385-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>, </span>
<span id="cb385-5"><a href="week-5--r-continued.html#cb385-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">width=</span><span class="fl">0.1</span>), <span class="at">size=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-23-1.png" width="768" />
Line plots such as this are really great to assess change over time. It is important to note that in the scatter plot earlier each point was an individual chick, but now we see each point in the mean weight of all chicks at each time point.</p>
<p> </p>
</div>
<div id="group-exercise-on-data-visualization" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Group Exercise on Data Visualization<a href="week-5--r-continued.html#group-exercise-on-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we will go through an exercise using genomic data from <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/jbi.14229">this study</a>.</p>
<p>Let’s download and explore the data. In terminal run the following:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb386-1"><a href="week-5--r-continued.html#cb386-1" aria-hidden="true" tabindex="-1"></a>wget https://raw.githubusercontent.com/BayLab/MarineGenomicsData/main/week5_2022.table.tar.gz</span>
<span id="cb386-2"><a href="week-5--r-continued.html#cb386-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-3"><a href="week-5--r-continued.html#cb386-3" aria-hidden="true" tabindex="-1"></a>tar -xzvf week5_2022.table.tar.gz</span></code></pre></div>
<p> </p>
<p>Move the downloaded data into your working R directory.</p>
<p>Currently, the working directory is set to our home directory. In Rstudio you can change the working directory to the week5 directory we just downloaded data into by using the pull down menu <code>Session</code> to get and set your working directory. Similarly, the tab <code>Files</code> in the lower right will also allow you to set your working directory.</p>
<p>Then we can read the data table with the ‘read.csv’ command, calling our data.frame “gen.data”</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb387-1"><a href="week-5--r-continued.html#cb387-1" aria-hidden="true" tabindex="-1"></a>gen.data <span class="er">&lt;</span>- read.csv(file = &#39;margen.wk5.table.csv&#39;, sep = &#39;;&#39;)</span>
<span id="cb387-2"><a href="week-5--r-continued.html#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="week-5--r-continued.html#cb387-3" aria-hidden="true" tabindex="-1"></a>gen.data</span>
<span id="cb387-4"><a href="week-5--r-continued.html#cb387-4" aria-hidden="true" tabindex="-1"></a>str(gen.data)</span>
<span id="cb387-5"><a href="week-5--r-continued.html#cb387-5" aria-hidden="true" tabindex="-1"></a>View(gen.data)</span></code></pre></div>
<p>Looking at this dataframe we see the following variables:</p>
<p>1- genomic diversity (GD; specifically expected heterozygosity values)</p>
<p>2- range position (RP; distance, in km, each site is from the center of the species’ range)</p>
<p>3- region (RE; what bioregion the site falls within)</p>
<p>4- species (SPP; urchin-Parechinus angulosus, crab-Cyclograpsus punctatus, limpet-Scutellastra granularis)</p>
<p> </p>
<p>We will do the following two exercises in groups of 2-3. You are welcome to draw out the plots first, then attempt to create them with R code (either base R or ggplot2). Make sure they are clear for others to interpret.</p>
<p>There are many ways to accomplish each exercise, and therefore solutions are not given below. Students can share what they created in class.</p>
<blockquote>
<h1 id="group-exercise-1" class="hasAnchor">Group Exercise 1<a href="week-5--r-continued.html#group-exercise-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</blockquote>
<blockquote>
<p>The central-margin theory suggest that genetic diversity should be highest within the center of the species’ distributional range. Let’s explore if this is true in our dataset.</p>
<p>1.1 Let’s take a look at the two variables GD and RP. Are they continuous or characters? Here we are also interested in the three species- is SPP continuous or categorical?</p>
</blockquote>
<blockquote>
<p>1.2 If we want to look at a relationship between genetic diversity (GD) and range position (RP), what type of graph will allow us to look at their correlation?</p>
</blockquote>
<blockquote>
<p>1.3 We are specifically interested in comparing the relationship between GD and RP across the three species. What is the best way to view GD~RP per each individual species? Hint: have a look towards the later plots in this week’s lesson for ideas.</p>
</blockquote>
<blockquote>
<p>1.4 Design and plot a figure that will best show the relationship between genetic diversity and range position per species. Do we find that genetic diversity is higher towards the middle of the range in any species? Remember, smaller values of RP represent areas closer to the center of the range.</p>
</blockquote>
<blockquote>
<h1 id="group-exercise-2" class="hasAnchor">Group Exercise 2<a href="week-5--r-continued.html#group-exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</blockquote>
<blockquote>
<p>The biogeography of an area is an important feature shaping genomic diversity of multiple species. In this second exercise, we want to compare the different regions (west vs south vs east coast bioregions) in the mean and range of genetic diversity values within each region.</p>
</blockquote>
<blockquote>
<p>2.1 Let’s think about the variables we want to compare. What columns are we going to use to make this plot? Remember we want to look at the values of genetic diversity (of all species), and if these signficantly differ between region.</p>
</blockquote>
<blockquote>
<p>2.2 Of the variables we want to plot, which are continuous and which are categorical?</p>
</blockquote>
<blockquote>
<p>2.3 Here we are interested in comparing the means and variation of values between groups. What type of plot is best suited for this? Hint: have a look at section 6.4.</p>
</blockquote>
<blockquote>
<p>2.4 Design and plot a graph that will show mean genetic diversity, as well as minimum and maximum values across different regions. Do we see differences in multi-species genetic diversity composition between the three regions?</p>
</blockquote>
<p> </p>
</div>
<div id="practice-problems-2.2" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Practice Problems 2.2<a href="week-5--r-continued.html#practice-problems-2.2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<h1 id="exercise-2.2-plotting-in-ggplot" class="hasAnchor">Exercise 2.2 Plotting in ggplot<a href="week-5--r-continued.html#exercise-2.2-plotting-in-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</blockquote>
<blockquote>
<ol style="list-style-type: decimal">
<li>Add best fit lines to our msleep plot (that we saved earlier as the object “g”) for each order. Hint: have a look at which ggplots shown earlier have lines of best fit and try to re-create that code.</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="week-5--r-continued.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can just use the geom_smooth command from above and ggplot takes care of the rest!</span></span>
<span id="cb388-2"><a href="week-5--r-continued.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The code below will only work if you stored your plot in object g.</span></span>
<span id="cb388-3"><a href="week-5--r-continued.html#cb388-3" aria-hidden="true" tabindex="-1"></a>g<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)</span>
<span id="cb388-4"><a href="week-5--r-continued.html#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula &#39;y ~ x&#39;</span></span>
<span id="cb388-5"><a href="week-5--r-continued.html#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 22 rows containing non-finite values (stat_smooth).</span></span>
<span id="cb388-6"><a href="week-5--r-continued.html#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 22 rows containing missing values (geom_point).</span></span></code></pre></div>
<img src="05-Week5_R_Introduction_continued_files/figure-html/5-24-1.png" width="768" />
</p>
</details>
<blockquote>
<ol start="2" style="list-style-type: decimal">
<li>With the msleep data, make a boxplot of sleep_total against vore. Make sure vore is a factor. Color the boxplots by vore (remember how we had to color the boxplots in base R- it is similar in ggplot). Which organisms have the most consistent hours of sleep?</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="week-5--r-continued.html#cb389-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-2"><a href="week-5--r-continued.html#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep, <span class="fu">aes</span>(<span class="at">y=</span>sleep_total, <span class="at">x=</span><span class="fu">as.factor</span>(vore), <span class="at">fill=</span><span class="fu">as.factor</span>(vore)))<span class="sc">+</span><span class="fu">geom_boxplot</span>()</span></code></pre></div>
<img src="05-Week5_R_Introduction_continued_files/figure-html/5-25-1.png" width="768" />
</p>
</details>
<blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Load a new dataframe <code>midwest</code>(run data(midwest)). Explore the dataframe. Here we are looking to see if area size has an effect on population density. Plot a scatterplot of ‘area’ against ‘popdensity’ grouped and colored by state. Do a facet grid by state here.</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="week-5--r-continued.html#cb390-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-2"><a href="week-5--r-continued.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">y=</span>area, <span class="at">x=</span>popdensity, <span class="at">col=</span><span class="fu">as.factor</span>(state)))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">facet_grid</span>(<span class="sc">~</span>state)</span></code></pre></div>
<img src="05-Week5_R_Introduction_continued_files/figure-html/5-26-1.png" width="768" />
</p>
</details>
<blockquote>
<ol start="4" style="list-style-type: decimal">
<li>In the midwest dataframe make a scatterplot of ‘popdensity’ by ‘poptotal’ of only IL (this requires you to subset your data for Illinois).</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="week-5--r-continued.html#cb391-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-2"><a href="week-5--r-continued.html#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="co">#we can subset our data first and store the subset in a new dataframe</span></span>
<span id="cb391-3"><a href="week-5--r-continued.html#cb391-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-4"><a href="week-5--r-continued.html#cb391-4" aria-hidden="true" tabindex="-1"></a>il<span class="ot">&lt;-</span>midwest[midwest<span class="sc">$</span>state <span class="sc">==</span> <span class="st">&quot;IL&quot;</span>,]</span>
<span id="cb391-5"><a href="week-5--r-continued.html#cb391-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-6"><a href="week-5--r-continued.html#cb391-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(il, <span class="fu">aes</span>(<span class="at">x=</span>popdensity, <span class="at">y=</span>poptotal))<span class="sc">+</span><span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="05-Week5_R_Introduction_continued_files/figure-html/5-27-1.png" width="768" /></p>
</p>
</details>
<blockquote>
<ol start="5" style="list-style-type: decimal">
<li>In the midwest dataframe plot the mean and standard error for popdensity for each state. Color this plot in your favorite palette. Hint: google how to use the ‘stat_summary’ command for gglplot2.</li>
</ol>
</blockquote>
<details>
<summary>
<span style="color: red;">Solution</span>
</summary>
<p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="week-5--r-continued.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>state, <span class="at">y=</span>popdensity, <span class="at">color=</span>state))<span class="sc">+</span></span>
<span id="cb392-2"><a href="week-5--r-continued.html#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb392-3"><a href="week-5--r-continued.html#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb392-4"><a href="week-5--r-continued.html#cb392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>, </span>
<span id="cb392-5"><a href="week-5--r-continued.html#cb392-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">width=</span><span class="fl">0.1</span>), <span class="at">size=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb392-6"><a href="week-5--r-continued.html#cb392-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb392-7"><a href="week-5--r-continued.html#cb392-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rainbow</span>(<span class="dv">5</span>))</span>
<span id="cb392-8"><a href="week-5--r-continued.html#cb392-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: `fun.y` is deprecated. Use `fun` instead.</span></span>
<span id="cb392-9"><a href="week-5--r-continued.html#cb392-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-10"><a href="week-5--r-continued.html#cb392-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: `fun.y` is deprecated. Use `fun` instead.</span></span>
<span id="cb392-11"><a href="week-5--r-continued.html#cb392-11" aria-hidden="true" tabindex="-1"></a><span class="do">## geom_path: Each group consists of only one observation. Do you need to adjust</span></span>
<span id="cb392-12"><a href="week-5--r-continued.html#cb392-12" aria-hidden="true" tabindex="-1"></a><span class="do">## the group aesthetic?</span></span></code></pre></div>
<img src="05-Week5_R_Introduction_continued_files/figure-html/5-28-1.png" width="768" />
</p>
</details>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4---the-r-environment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="population-structure-via-construct.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MarGen2022.pdf", "MarGen2022.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
